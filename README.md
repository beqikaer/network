# 虚拟机openwrt软路由搭建及网络设置 

**1.openwrt软路由介绍及搭建**  

**第一步**

虚拟机文件下载到电脑中解压缩，然后在VMware Workstation软件中选择文件菜单里的打开命令，找到刚才解压缩的文件，导入虚拟机(需要大概1.5G的硬盘空间)  
虚拟机文件下载链接: https://pan.baidu.com/s/1kWRZtQn 密码: 5qcj  

**第二步** 
导入虚拟机  

![1.导入虚拟机.png](/openwrt/1.导入虚拟机.png)  

**第三步** 
开启虚拟机  

![2.开启虚拟机.png](/openwrt/2.开启虚拟机.png) 

        输入vi /etc/config/network  
        修改网卡，网卡配置如下，按需修改lan以及wan口的IP。wq!保存  

**第四步**  
配置网络  

![3.配置网络.png](/openwrt/3.配置网络.png)  

        service network restart重启网卡 

  这里需要说明的是：  

        LAN口为内网口，WAN为外网口，这一步相当于，给软路由设定一个网关（LAN），WAN可直接将option proto设置成DHCP  

        因为openwrt有wan、lan口则需要两块网卡，如下：  

        第一块网卡是lan口网卡，我这里处于31网段，192.168.31.11。  
        第二块网卡是wan口网卡，直接桥接，option proto设置成DHCP。  

   **注意**： 
   
        在给虚拟机添加网卡的时候，openwrt虚拟机两块网卡顺序不能变，第一块为lan口网卡，第二块为wan口网卡  

![3.配置网络网卡顺序.png](/openwrt/3.配置网络网卡顺序.png)   

**介绍三种虚拟网卡的区别**
        
        1.桥连接
           所谓的桥连接，就是说虚拟机的网络ip地址与我们的主机（母机）的ip在一个网段，加入我们windows机器的ip是192.168.172.11，那虚拟机的ip也将在92.168.172.XXX这个网络，这样虚拟机虽然可以直接上网也可以与主机互通但是可能会造成较多的网络ip冲突！
        
![4.虚拟机网卡介绍-桥接真机网卡](/openwrt/4.虚拟机网卡介绍-桥接真机网卡.png)   
        
        
        2.Net模式
           即网络装换模式，net模式就是使用默认vmnet8这个虚拟网卡进行通信的（可以自建，不过虚拟机内只允许一个net模式网卡），//这样我们的主机（母机）就会有两个ip地址。
           这样我们母机本身使用自己的ip（172.17.202.69），虚拟机使用（192.168.172.XXX）这个网段的ip,这样就可以与虚拟机相互通信！这样的话就不会占用ip,但是其他（同事、同学在同一个网段的）主机就无法连接我们的虚拟机，因为不在同一个网段，而我们的虚拟机是可以通过我们主机的本身（172.17.202.69）的代理找到其他同一网段的主机的。
           
![5.虚拟机网卡介绍-主机模式虚拟网卡网段](/openwrt/5.虚拟机网卡介绍-主机模式虚拟网卡网段.png)
          
           
        3.仅主机模式
            host-only模式，虚拟机完全是一个独立的主机，与母机不会互通也不能连接到网络！（像软路由就可以独立，没有必要一定和母机通讯）

        

**至此软路由搭建完毕，如需配置需要在，网关、网段内搭建可操作的win操作系统**  

![3.网段内ip设置.png](/openwrt/3.网段内ip设置.png)   

            打开浏览器输入openwrt地址，设置的openwrt网关,我这里192.168.31.11。(推荐chrom浏览器)

            账号：root  密码123456


2.群晖系统的搭建  
3.win7系统搭建  
4.虚拟机网络配置  
 
